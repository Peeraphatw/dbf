* APCSH.RL - ãº«×éÍÊ´ (CASH PURCHASING)
*
[report frame]
*** ¼ÙéãªéÊÒÁÒÃ¶à»ÅÕèÂ¹á»Å§á¡éä¢ ä´éµÒÁµéÍ§¡ÒÃ ****************************************
Ti:: ~INIT
He:$E\NAME                                             $E
He:~ADDR
He:~TEL                                              $Eãº«×éÍà§Ô¹Ê´$E
He:                       àÅ¢»ÃÐ¨ÓµÑÇ¼ÙéàÊÕÂÀÒÉÕ ~TAXID
He:  ¼Ùé¨ÓË¹èÒÂ ~SUPCOD                               àÅ¢·Õèãº«×éÍÊ´    ~DOCNUM
He:  ~SUPNAM                                          ÇÑ¹·Õè            ~DOCDAT
He:  ~ADDR01
He:  ~ADDR02                                          ãºÊÑè§«×éÍàÅ¢·Õè  ~PONUM      ÇÑ¹·Õè ~PODAT
He:  àÅ¢·ÕèºÔÅ  ~REFNUM         ÅÇ·.~VATDAT
He:  ËÁÒÂàËµØ   ~YOUREF                               ¢¹Êè§â´Â          ~DLVBY
He:€…………‰…………………………………………………………………………………………………………………‰…………………………………………‰……………………………‰……………………………………
He:„ No.„            ÃËÑÊÊÔ¹¤éÒ/ÃÒÂÅÐàÍÕÂ´          „     ¨Ó¹Ç¹      „   Ë¹èÇÂÅÐ „ ~TXT0        „
He:†…………Š…………………………………………………………………………………………………………………Š…………………………………………Š……………………………Š……………………………………‡
Bo::
Ih::					;1 stcrd->docnum aptrn->docnum
Ib: ~N    ~ARTICLE                                   ~QTY    ~TQUCOD  ~UNITPR     ~NETAMT_I		;1
Ih::                    ;2 ARTRNRM->docnum+ARTRNRM->seqnum stcrd->rdocnum
Ib:       ~REMARK		;2
Ih::                    ;3 artrnrm->docnum+artrnrm->seqnum stcrd->docnum+stcrd->seqnum
Ib:       ~REMARK		;3
Ih:                     ;4 aprcpcq->rcpnum aptrn->docnum
Ih:      ªÓÃÐâ´ÂÍ×è¹ æ :-
Ib:       ~BY               ~CHQNUM    ~PAYAMT_Q         ~CHQDAT       ~BNKACC   ~AMOUNT_Q      ;4
Ih:      ãºËÑ¡ÀÒÉÕ :-	;5 istax->refnum aptrn->docnum
Ib:      ~PTAX    àÅ¢·Õè    ~TAXNUM    ~TAXDAT ~PAYAMT      ~TAXAMT      ~TAXP ;5
Ib:                                    ËÑ¡äÇé  ~RATE % ÊÓËÃÑº   ~TAXDES    ;5
Bt:„    „                                           „                „           „              „
Fo:†…………ˆ…………………………………………………………………………………………………………………ˆ…………………………………………ˆ……………………………Š……………………………………‡
Su:„ËÁÒÂàËµØ                                         ÃÇÁà»ç¹à§Ô¹                 „~AMOUNT       „
Su:„ ~HREM1                                          $_ËÑ¡$_ÊèÇ¹Å´        ~DISC      „~DISCAMT      „
Su:„ ~HREM2                                          ÂÍ´ËÅÑ§ËÑ¡ÊèÇ¹Å´            „~AFTDISC      „
Su:„ ~HREM3                                          $_ËÑ¡$_à§Ô¹ÁÑ´¨Ó   #~ADVNUM     „~ADVAMT       „
Su:„ ~HREM4                                          ~TXT1                       „~TOTAL        „
Su:„ ~HREM5                                          ¨Ó¹Ç¹ÀÒÉÕÁÙÅ¤èÒà¾ÔèÁ ~VAT % „~VATAMT       „
Su:„                                                        ~TXT2                „~CHKAMT       „
*Su:„ ~HREM3                                                                      „……………………………………„
*Su:„ ~HREM4                                          ÊÔ¹¤éÒÂ¡àÇé¹ÀÒÉÕÁÙÅ¤èÒà¾ÔèÁ „~AMTRATZ      „
*Su:„ ~HREM5                                          ÁÙÅ¤èÒÊÔ¹¤éÒÍÑµÃÒ    ~VAT % „~AMTRATX      „
*Su:„                                                 ¨Ó¹Ç¹à§Ô¹ÀÒÉÕÁÙÅ¤èÒà¾ÔèÁ    „~VATAMT       „
*Su:„~BAHT                                                   ¨Ó¹Ç¹à§Ô¹ÃÇÁ·Ñé§ÊÔé¹ „~NETAMT       „
Su:†………………………………………‰………………………………………‰…………………………………………‰…………………………………………………………………………Š……………………………………‡
Su:„     à§Ô¹Ê´    „ ªÓÃÐâ´ÂÍ×è¹æ  „ ÀÒÉÕ ³ ·Õè¨èÒÂ „                            „ ÂÍ´¨èÒÂÊØ·¸Ô „
Su:„ ~CSHPAY       „ ~CHQPAY       „ ~TAX           „                            „~NET          „
Su:†………………………………………ˆ………………………………………ˆ…………………………………………ˆ…………………………………………………………………………ˆ……………………………………‡
Su:„~BAHT                                                                                       „
Su:„                                                                                            „
Su:„ ª×èÍ¼ÙéÃÑºÊÔ¹¤éÒ ____________________                 ª×èÍ¼ÙéµÃÇ¨ÊÍº ____________________  „
Su:„ ÇÑ¹·Õè    ___/___/___                                 ÇÑ¹·Õè     ___/___/___               „
Su:„                                                                                            „
Su:‚……………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………ƒ
[end frame]

*** ¤ÓÊÑè§µèÍ¨Ò¡¹Õé ¼ÙéãªéäÁè¤ÇÃá¡éä¢ ****************************************

[print options]
Top=0
Left=0
Tabs=4
Right=94
Lines=41
Output=Select, Printer, Screen, File,
File Name=APCSH.TXT
Print Control=\027\033\001
Fix Summary Line=ON
Select Scope=OFF
Select Page=OFF
Condition=OFF

[range of report]
From=CUR

[master file]
File=aptrn
Alias=A
Tag=aptrn1
System=DATA_PATH

[item file]
File=stcrd
Alias=B
Tag=stcrd5
System=DATA_PATH

File=artrnrm
Alias=C
Tag=artrnrm1
System=DATA_PATH

File=aprcpcq
Alias=D
Tag=aprcpcq1
System=DATA_PATH

File=istax
Alias=T
Tag=istax1
System=DATA_PATH

[relate file]
File=apmas
Alias=R
Tag=apmas1
System=DATA_PATH
Master file=aptrn
Master-Related Field=SUPCOD

File=stmas
Alias=Z
Tag=stmas1
System=DATA_PATH
Master file=stcrd
Master-Related Field=STKCOD

File=bktrn
Alias=K
Tag=bktrn3
System=DATA_PATH
Master file=aprcpcq
Master-Related Field=CHQNUM

File=bkmas
Alias=L
Tag=bkmas1
System=DATA_PATH
Master file=bktrn
Master-Related Field=BNKACC

File=popr
Alias=Y
Tag=popr1
System=DATA_PATH
Master file=aptrn
Master-Related Field=PONUM

File=stloc
Alias=L
Tag=stloc1
System=DATA_PATH
Master file=stcrd
Master-Related Field=STKCOD+LOCCOD

[data spec]
*		    len  (0)default, (>0)cut, (<0)cut to new line
*~dat:		len,	"pict",			 	"data",				"exp"
~ADDR:		0,		"",					"p_addr()",			""
~TAXID:		0,		"",					"p_taxid()",		""
~TEL:       0,      "",                 "p_telnum()",       ""
~INIT:		0,		"",					"",					"seq=0"
~TXT0:		0,		"",					"txt0",				"txt0 = IIF( APTRN->FLGVAT <> '1', '  ¨Ó¹Ç¹à§Ô¹', 'ÃÒ¤ÒÃÇÁÀÒÉÕ')",
*~TXT1:		0,		"",					"txt1",				"txt1 = IIF( APTRN->FLGVAT <> '1', '¨Ó¹Ç¹à§Ô¹ËÅÑ§ËÑ¡ÊèÇ¹Å´', '¨Ó¹Ç¹à§Ô¹ÃÇÁ·Ñé§ÊÔé¹  ')",
~TXT1:		0,		"",					"txt1",				"txt1 = IIF( APTRN->FLGVAT <> '1', '¨Ó¹Ç¹à§Ô¹ËÅÑ§ËÑ¡ÁÑ´¨Ó ', '¨Ó¹Ç¹à§Ô¹ÃÇÁ·Ñé§ÊÔé¹  ')",
~TXT2:		0,		"",					"txt2",				"txt2 = IIF( APTRN->FLGVAT <> '1', '¨Ó¹Ç¹à§Ô¹ÃÇÁ·Ñé§ÊÔé¹', 'ÃÒ¤ÒÊÔ¹¤éÒ          ')",
~DOCNUM:	0,		"",					"APTRN->DOCNUM",	""
~DOCDAT:	0,		"",					"APTRN->DOCDAT",	""
~SUPCOD:	0,		"",					"APTRN->SUPCOD",	""
~SUPNAM:	0,		"",					"sup_nam",			"sup_nam = APMAS->PRENAM - ' ' - APMAS->SUPNAM"
~ADDR01:	0,		"",					"APMAS->ADDR01",	""
~ADDR02:	0,		"",					"addr_02",			"addr_02 = APMAS->ADDR02 - ' ' - APMAS->ZIPCOD"
~REFNUM:	0,		"",					"APTRN->REFNUM",	""
~VATDAT:	0,		"",					"vat_dat",			"vat_dat = IIF(APTRN->FLGVAT#'0'.AND.APTRN->REFNUM#'   ',APTRN->VATDAT,CTOD('        '))"
~YOUREF:	0,		"",					"APTRN->YOUREF",	""
~DLVBY:	    0,		"",					"p_istab( APTRN->DLVBY, 41, 1, 40 )",			""
~PONUM:     0,      "",                 "APTRN->PONUM",     ""
~PODAT:		0,		"",					"POPR->PODAT",		""
~FLGVAT:	0,		"Y",				"APTRN->FLGVAT",	""
~AMOUNT:	0,		"99,999,999.99",	"APTRN->AMOUNT",	""
~DISC:		0,		"",					"APTRN->DISC",		""
~DISCAMT:	0,		"99,999,999.99",	"APTRN->DISCAMT",	""
~AFTDISC:	0,		"99,999,999.99",	"APTRN->AFTDISC",	""
~ADVNUM:	0,		"",					"APTRN->ADVNUM",	""
~ADVAMT:	0,		"99,999,999.99",	"APTRN->ADVAMT",	""
~TOTAL:		0,		"99,999,999.99",	"APTRN->TOTAL",		""
~VAT:		0,		"99.99",			"APTRN->VATRAT",	""
~VATAMT:	0,		"99,999,999.99",	"APTRN->VATAMT",	""
~CHKAMT:	0,		"99,999,999.99",	"netamt",			"netamt = IIF( APTRN->FLGVAT <> '1', APTRN->NETAMT, APTRN->TOTAL - APTRN->VATAMT)"
~BAHT:		0,		"",					"t_baht(APTRN->CSHPAY+APTRN->CHQPAY)", 	""
~AMTRATZ:	0,		"99,999,999.99",	"AMTRATZ",			"AMTRATZ = APTRN->AMTRAT0 - (APTRN->AMTRAT0 * APTRN->DISCAMT / APTRN->AMOUNT)"
~AMTRATX:	0,		"99,999,999.99",	"AMTRATX",			"AMTRATX = IIF(APTRN->FLGVAT='1',APTRN->TOTAL - AMTRATZ - APTRN->VATAMT, APTRN->TOTAL - AMTRATZ)"
~NETAMT:	0,		"99,999,999.99",	"APTRN->NETAMT",	""

~N:			0,		"999",				"seq",				"seq=seq+1"
~ARTICLE:  43,		"",					"article",			"article = STCRD->STKCOD - ' ' - STMAS->STKDES"
~STKCOD:   15,		"",					"STCRD->STKCOD",	""
~STKDES:   28,		"",					"STMAS->STKDES",	""
~L:			0,		"",					"STCRD->LOCCOD",	""
~QTY:		0,		"qtyZ(7)",			"STCRD->TRNQTY",	""
~TQUCOD:	0,		"",					"p_istab( STCRD->TQUCOD,  20, 1, 0 )",		"",
~UNITPR:	0,		"priZ(10)",			"STCRD->UNITPR",	""
~DISC_I:	0,		"",					"STCRD->DISC",		""
~NETAMT_I:	0,		"ZZ,ZZZ,ZZZ.ZZ",	"STCRD->TRNVAL",	""
~REMARK:	0,		"",					"ARTRNRM->REMARK",	""

~BY:        0,      "",                 "p_isrun( APRCPCQ->CHQNUM, ZP, 1, 0)", ""
~CHQNUM:	0,		"",					"chqnum",			"chqnum= substr(APRCPCQ->CHQNUM,3,8)"
~CHQDAT:	0,		"",					"BKTRN->CHQDAT",	""
~BNKACC:	0,		"",					"BKMAS->SHORTNAM",	""
~AMOUNT_Q:	0,		"ZZ,ZZZ,ZZZ.ZZ",	"BKTRN->AMOUNT",	""
~REMAMT_Q:	0,		"ZZ,ZZZ,ZZZ.ZZ",	"BKTRN->REMAMT",	""
~PAYAMT_Q:	0,		"ZZ,ZZZ,ZZZ.ZZ",	"APRCPCQ->PAYAMT",	""

~CSHPAY:	0,		"99,999,999.99",	"APTRN->CSHPAY",	""
~CHQPAY:	0,		"99,999,999.99",	"APTRN->CHQPAY",	""
~TAX:		0,		"9,999,999.99",		"APTRN->TAX",		""
~NET:		0,		"99,999,999.99",	"net",				"net=IIF(APTRN->NETAMT = APTRN->PAYAMT, APTRN->CSHPAY+APTRN->CHQPAY, 99999999999.99)"

~HREM1:		0,		"",					"p_hrem( A->DOCNUM,1,A->PONUM )",    ""
~HREM2:		0,		"",					"p_hrem( A->DOCNUM,2,A->PONUM )",    ""
~HREM3:		0,		"",					"p_hrem( A->DOCNUM,3,A->PONUM )",    ""
~HREM4:		0,		"",					"p_hrem( A->DOCNUM,4,A->PONUM )",    ""
~HREM5:		0,		"",					"p_hrem( A->DOCNUM,5,A->PONUM )",    ""

~DEP:		0,		"",					"A->DEPCOD",				""
~P_ISDEP:	0,		"",					"p_isdep( A->DEPCOD )",		""
~LOCAREA:	0,		"",					"STLOC->AREA",				""
~RDOCNUM:	0,		"",					"po",						"po = SUBSTR( STCRD->RDOCNUM,1,12)"

~TAXNUM:	0,		"",					"ISTAX->TAXNUM",	""
~TAXDAT:	0,		"",					"ISTAX->TAXDAT",	""
~TAXNAM:	0,		"",					"ISTAX->NAME",		""
~TAXADDR:	0,		"",					"ISTAX->ADDR",		""
~TAXID:		0,		"",					"ISTAX->TAXID",		""
~TAXDES:	0,		"",					"ISTAX->TAXDES",	""
~PTAX:		0,		"",					"",					"prd = @format_date( ISTAX->TAXPRD, MM/YY )"
~TAXP:		0,		"",					"tax_prd",			"tax_prd=IIF( SUBSTR(DTOS(ISTAX->TAXPRD),1,6) # SUBSTR(DTOS(ISTAX->TAXDAT),1,6), '(Â×è¹ÃÇÁã¹§Ç´ '+prd+ISTAX->LATE+')', '                     ')"
~PAYAMT:	0,		"99,999,999.99",	"ISTAX->AMOUNT",	""
~RATE:		0,		"999.99",			"ISTAX->TAXRAT",	""
~TAXAMT:	0,		"9,999,999.99",		"ISTAX->TAXAMT",	""
